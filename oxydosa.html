<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="AIMLab. - Artificial Intelligence in Medicine Laboratory Website">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Title -->
    <title>OxyDOSA App</title>

    <!-- Favicon -->
    <link rel="icon" href="./img/core-img/favicon.ico">

    <!-- Core Stylesheet -->
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="wrapper">
            <div class="cssload-loader"></div>
        </div>
    </div>

    <!-- ***** Header Area Start ***** -->
    <header class="header-area">
        <!-- Main Header Start -->
        <div class="main-header-area">
            <div class="classy-nav-container breakpoint-off">
                <!-- Classy Menu -->
                <nav class="classy-navbar justify-content-between" id="uzaNav">

                    <!-- Logo -->
                    <a class="nav-brand" href="index.html"><img src="./img/core-img/logo.png" alt=""></a>

                    <!-- Navbar Toggler -->
                    <div class="classy-navbar-toggler">
                        <span class="navbarToggler"><span></span><span></span><span></span></span>
                    </div>

                    <!-- Menu -->
                    <div class="classy-menu">
                        <!-- Menu Close Button -->
                        <div class="classycloseIcon">
                            <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                        </div>

                        <!-- Nav Start -->
                        <div class="classynav">
                            <ul id="nav">
                                <li><a href="./index.html">Home</a></li>
                                <li><a href="./team.html">Team</a></li>
                                <li><a href="#">Research</a>
                                    <ul class="dropdown">
                                        <li><a href="./research.html">Research Topics</a></li>
                                        <li><a href="./publications.html">Publications</a></li>
                                    </ul>
                                </li>
                                <li><a href="./positions.html">Positions</a></li>
                                <li><a href="./software.html">Software</a>
                                    <ul class="dropdown">
                                        <li class="current-item"><a href="./oxydosa.html">OxyDOSA</a></li>
                                        <li><a href="http://fecgsyn.com/ ">FECGSYN</a></li>
                                        <li><a href="https://physiozoo.com/">PhysioZoo</a></li>
                                    </ul>
                                </li>
                                
                                <li><a href="./contact.html">Contact</a></li>
                            </ul>

                           
                        </div>
                        <!-- Nav End -->

                    </div>
                </nav>
            </div>
        </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <!-- ***** Breadcrumb Area Start ***** -->
    <div class="breadcrumb-area">
        <div class="container h-100">
            <div class="row h-100 align-items-end">
                <div class="col-12">
                    <div class="breadcumb--con">
                        <h2 class="title">OxyDOSA App</h2>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#"><i class="fa fa-home"></i> Home</a></li>
                                <li class="breadcrumb-item" aria-current="page">Software</li>
                                <li class="breadcrumb-item active" aria-current="page">OxyDOSA App</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <!-- Background Curve -->
        <div class="breadcrumb-bg-curve">
            <img src="./img/core-img/curve-5.png" alt="">
        </div>
    </div>
    <!-- ***** Breadcrumb Area End ***** -->

    <!-- ***** Contact Area Start ***** -->
    <section class="uza-contact-area section-padding-80">
        <div class="container">
            <div class="row justify-content-between">
                <!-- Contact Form -->
                <div class="col-12 col-lg-8">
                    <div class="uza-contact-form mb-80">
                        <div class="contact-heading mb-50">
                            <h4>Background:</h4>
                            The OxyDOSA model was developed by Behar, Palmius and colleagues [1] for the purpose of obstructive sleep apnea (OSA) screening from a minimal
                            set of oxygen saturation and demographic features. An implementation of the machine learning model trained on a representative
                            population sample of 887 individuals is provided bellow. Disclaimer 
                            <a href="./docs/AIMLab.MedicalDisclaimer.pdf" style="color:#1583e9">here</a>.</h4>
                            <h4>Fill out the form below to obtain the OxyDOSA score:</h4>
                        </div>
                 
                        <form name="oxydosa_form" id="oxydosa_form">
                            <div class="row">
                                
                                <div class="col-12">
                                        <div>
                                            <select class="form-control mb-40" id="guideline" name="guideline" required>
                                                <option value="" disabled selected>Guideline</option>                                          
                                                <option>AHI17A</option>
                                                <option>AHI17R</option>
                                                <option>RDI17A</option>
                                                <option>RDI17R</option>
                                            </select>
                                            <label for="guideline" class="label-area-select-long">Guideline</label>                                            
                                        </div>       
                                </div>
                                

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <input type="text" class="form-control mb-40" id="odi" name="odi" data-toggle="tooltip" data-placement="Left" title="The 3% oxygen desaturation index" required>
                                        <label for="odi" class="label-area">ODI</label>    
                                                    
                                    </div>
                                </div>

                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <input type="text" class="form-control mb-40" id="t90" name="t90" data-toggle="tooltip" data-placement="Right" title="The proportion of time spent with SpO2<90%" required>
                                        <label for="t90" class="label-area">T90</label>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <input type="text" class="form-control mb-40" id="mspo2" name="mspo2" data-toggle="tooltip" data-placement="Left" title="The mean oxygen saturation" required>
                                        <label for="mspo2" class="label-area">MSpO2</label>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <input type="text" class="form-control mb-40" id="spo2Nadir" name="spo2Nadir" data-toggle="tooltip" data-placement="Right" title="Lowest value of oxygen saturation" required>
                                        <label for="spo2Nadir" class="label-area">SpO2 Nadir</label>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                        
                                        <div class="form-group">
                        
                                            <select class="form-control mb-40" id="hbp" name="hbp" placeholder="sdg" required>
                                                <option value="" disabled selected>High blood pressure</option>
                                                <option>No</option>
                                                <option>Yes</option>
                                            </select>
                                            <label for="hbp" class="label-area-select">High blood pressure</label> 
                                        </div>
                                </div>
                                <div class="col-lg-6">
                                        <div>
                                            <select class="form-control mb-40" id="gender" name="gender" required> 
                                                <option value="" disabled selected>Gender</option>                                
                                                <option>Female</option>
                                                <option>Male</option>
                                            </select>
                                            <label for="hbp" class="label-area-select">Gender</label> 
                                        </div>
                                </div>
                                <div class="col-lg-6">
                                        <div>
                                            <select class="form-control mb-40" id="snoring" name="snoring" required>
                                                <option value="" disabled selected>Snoring Level</option>  
                                                <option>Does not snore</option>
                                                <option>As loud as breathing</option>
                                                <option>As loud as talking</option>
                                                <option>Louder than talking</option>
                                                <option>Can be heard in another room</option>
                                            </select>
                                            <label for="hbp" class="label-area-select">Snoring Level</label> 
                                        </div>
                                </div>
                                <div class="col-lg-6">
                                        <div>
                                            <select class="form-control mb-40" id="fatigue" name="fatigue" required>                                        
                                                <option value="" disabled selected>Freq. daytime fatigue</option> 
                                                <option>Never</option>
                                                <option>1-2x/Month</option>
                                                <option>1-2x/Week</option>
                                                <option>3-4x/Week</option>
                                                <option>Daily</option>
                                            </select>
                                            <label for="hbp" class="label-area-select">Freq. daytime fatigue</label> 
                                        </div>
                                </div>
                                <div class="col-lg-6">
                                        <div>
                                            <select class="form-control mb-40" id="obs"  name="obs" required>
                                                <option value="" disabled selected>Freq. observed stop breathing</option>
                                                <option>Never</option>
                                                <option>1-2x/Month</option>
                                                <option>1-2x/Week</option>
                                                <option>3-4x/Week</option>
                                                <option>Daily</option>
                                            </select>
                                            <label for="hbp" class="label-area-select">Freq. observed stop breathing</label> 
                                        </div>
                                </div>
                                <div class="col-lg-6">
                                        <div class="form-group">
                                            <input type="text" class="form-control mb-40" id="bmi" name="bmi" required>
                                            <label for="bmi" class="label-area">BMI</label>
                                        </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <input type="text" class="form-control mb-40" id="age" name="age" required>
                                        <label for="age" class="label-area">Age</label>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <input type="text" class="form-control mb-40" id="nc" name="nc" required>
                                        <label for="nc" class="label-area">Neck Circumference</label>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    
                                    <div class="post-content text-center mb-40">
                                        <!-- <button class="btn uza-btn btn-3 mt-15">Compute Score</button> -->
                                  
                                        <button class="btn uza-btn btn-3 mt-15" onclick="requestScore()" data-toggle="modal" data-target="#searchModal">Compute Score</button>
                                        <button class="btn uza-btn btn-3 mt-15" onclick="clearForm()">Clear</button>
                                        <button class="btn uza-btn btn-3 mt-15" onclick="loadProfile()">Test</button>
                                        <!-- <h5 id="scoreResult"></h5> -->
                                    </div>
                                   
                                </div>
                                <br><br>

                                
                                <br><br>
                                [1] Joachim A. Behar*, Niclas Palmius*, Qiao Li, Silverio Garbuio, Fab√¨ola P. G Rizzatti, 
                                Lia Bittencourt, Sergio Tufik#, Gari D. Clifford#.
                                Feasibility of single channel oximetry monitoring for obstructive sleep apnea screening. 
                                Under review in EClinicalMedicine.
                                * Equal contribution.
                                # Equal senior authorship.
                            </div>
                        </form>

                    </div>
                </div>
        </div>
    </section>
    <!-- ***** Contact Area End ***** -->

      <!-- ***** Top Search Area Start ***** -->
      <div class="top-search-area">
        <!-- Search Modal -->
        <div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <!-- Close Button -->
                        <button type="button" class="btn close-btn" data-dismiss="modal"><i class="fa fa-times"></i></button>
                        <!-- Form -->
                        <form action="index.html" method="post">
                            <input type="search" id="scoreResult" name="top-search-bar" class="form-control" placeholder="">
                            <!-- <button type="submit" data-dismiss="modal">Close</button> -->
                        </form>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ***** Top Search Area End ***** -->


    <!-- ***** Footer Area Start ***** -->
    <footer class="footer-area section-padding-80-0">
            <div class="container">
                <div class="row justify-content-between">
                </div>
    
                <div class="row" style="margin-bottom: 30px;">
                                
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                </div>
    
            </div>
    </footer>
    <!-- ***** Footer Area End ***** -->


    <!-- ******* All JS Files ******* -->
    <!-- jQuery js -->
    <script src="js/jquery.min.js"></script>
    <!-- Popper js -->
    <script src="js/popper.min.js"></script>
    <!-- Bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- All js -->
    <script src="js/uza.bundle.js"></script>
    <!-- Active js -->
    <script src="js/default-assets/active.js"></script>


    <script type="text/javascript">


        function loadProfile(){

            document.getElementById("guideline").selectedIndex = 1;
            document.getElementById("mspo2").value = 94.32115935; //SPO2_MEAN_TRT
            document.getElementById("spo2Nadir").value = 91; //SPO2_PERCENTILE_1_TRT
            document.getElementById("t90").value = 0.002633415; //SPO2_BELOW_90_TRT
            document.getElementById("odi").value = 14.44018137; //DESAT_INDEX_TRT_ALL
            document.getElementById("snoring").selectedIndex = 2; //SB_RAW_SNORING_LEVEL
            document.getElementById("fatigue").selectedIndex = 3; //SB_RAW_DAYTIME_FATIGUE
            document.getElementById("obs").selectedIndex = 1; //SB_RAW_FREQ_OBS_APNOEA
            document.getElementById("hbp").selectedIndex = 1; //SB_SCORE_HIGH_BP
            document.getElementById("bmi").value = 32.06; //SB_RAW_BMI
            document.getElementById("age").value = 34; //SB_RAW_AGE
            document.getElementById("gender").selectedIndex = 2; //SB_SCORE_GENDER
            document.getElementById("nc").value = 43; //SB_RAW_NECK_CIRC */

            event.preventDefault(); 
        }

        function clearForm(){

        document.getElementById("guideline").selectedIndex = undefined;
        document.getElementById("mspo2").value =  ""; //SPO2_MEAN_TRT
        document.getElementById("spo2Nadir").value = ""; //SPO2_PERCENTILE_1_TRT
        document.getElementById("t90").value =  ""; //SPO2_BELOW_90_TRT
        document.getElementById("odi").value =  ""; //DESAT_INDEX_TRT_ALL
        document.getElementById("snoring").selectedIndex =  ""; //SB_RAW_SNORING_LEVEL
        document.getElementById("fatigue").selectedIndex =  ""; //SB_RAW_DAYTIME_FATIGUE
        document.getElementById("obs").selectedIndex =  ""; //SB_RAW_FREQ_OBS_APNOEA
        document.getElementById("hbp").selectedIndex =  ""; //SB_SCORE_HIGH_BP
        document.getElementById("bmi").value =  ""; //SB_RAW_BMI
        document.getElementById("age").value =  ""; //SB_RAW_AGE
        document.getElementById("gender").selectedIndex =  ""; //SB_SCORE_GENDER
        document.getElementById("nc").value =  ""; //SB_RAW_NECK_CIRC */

        event.preventDefault(); 
}
                
        function requestScore(){

            var method = document.getElementById("guideline").selectedIndex;
            var mspo2 = document.getElementById("mspo2").value; //SPO2_MEAN_TRT
            var spo2Nadir = document.getElementById("spo2Nadir").value; //SPO2_PERCENTILE_1_TRT
            var t90 = document.getElementById("t90").value; //SPO2_BELOW_90_TRT
            var odi = document.getElementById("odi").value; //DESAT_INDEX_TRT_ALL
            var snoring = document.getElementById("snoring").selectedIndex-1; //SB_RAW_SNORING_LEVEL
            var fatigue = document.getElementById("fatigue").selectedIndex-1; //SB_RAW_DAYTIME_FATIGUE
            var obs = document.getElementById("obs").selectedIndex-1; //SB_RAW_FREQ_OBS_APNOEA
            var hbp = document.getElementById("hbp").selectedIndex-1; //SB_SCORE_HIGH_BP
            var bmi = document.getElementById("bmi").value; //SB_RAW_BMI
            var age = document.getElementById("age").value; //SB_RAW_AGE
            var gender = document.getElementById("gender").selectedIndex-1; //SB_SCORE_GENDER
            var nc = document.getElementById("nc").value; //SB_RAW_NECK_CIRC */

            var xhttp;
            if (window.XMLHttpRequest) {
                // code for modern browsers
                xhttp = new XMLHttpRequest();
            } else {
                // code for IE6, IE5
                xhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {

                resultString = this.responseText;
                osa = resultString.slice(1,2);
                prob = (resultString.slice(3,-1)*100).toPrecision(4);

                document.getElementById("scoreResult").value = "Predicted OSA:  "+osa+"  with a probability of:  "+prob+"%";
                }
            };
            xhttp.open("POST", "https://aimlabmanager.pythonanywhere.com/", true);
   

            var data = new FormData();
            data.append('METHOD', method);
            data.append('SPO2_MEAN_TRT', mspo2);
            data.append('SPO2_PERCENTILE_1_TRT', spo2Nadir);
            data.append('SPO2_BELOW_90_TRT', t90);
            data.append('DESAT_INDEX_TRT_ALL', odi);
            data.append('SB_RAW_SNORING_LEVEL', snoring);
            data.append('SB_RAW_DAYTIME_FATIGUE', fatigue);
            data.append('SB_RAW_FREQ_OBS_APNOEA', obs);
            data.append('SB_SCORE_HIGH_BP', hbp);
            data.append('SB_RAW_BMI', bmi);
            data.append('SB_RAW_AGE', age);
            data.append('SB_SCORE_GENDER', gender);
            data.append('SB_RAW_NECK_CIRC', nc);

            xhttp.send(data);

            document.getElementById("scoreResult").value = "Getting Results...";

            event.preventDefault(); 
        }

    </script>
</body>
</html>
